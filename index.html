<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EXS Guide</title>
  <link rel="manifest" href="manifest.json">
    <!-- PWA 색상(안드로이드 툴바 색) -->
  <meta name="theme-color" content="#0044cc">

  <!-- iOS: 홈화면 추가 허용 + 상태바 스타일 -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="EXS Guide">

  <!-- iOS 아이콘(최소 180x180 권장) -->
  <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">

  <!-- JS로 동적으로 CSS 최신 로드 -->
  <script>
    const ts = Date.now();
    document.write(`<link rel="stylesheet" href="styles.css?v=${ts}">`);
  </script>
</head>
  <script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('./service-worker.js?swv=' + Date.now())
  .then(async (reg) => {
    // 새 워커가 오면 곧바로 활성화 시도
    if (reg.waiting) reg.waiting.postMessage({type:'SKIP_WAITING'});
    if (reg.installing) reg.installing.addEventListener('statechange', () => {
      if (reg.installing.state === 'installed') reg.installing.postMessage({type:'SKIP_WAITING'});
    });
  });
}
</script>
<body>
  <!-- 상단 배너 -->
  <header class="app-bar">
    <div class="brand" onclick="navigate('home')">
      <img src="icons/logo.png" alt="기관 로고" class="logo">
      <span>슬기로운 영업소 생활</span>
    </div>

    <div class="search-wrap">
      <input id="searchInput" type="search" placeholder="검색: 통행권, 민원, 화재..."
        oninput="onSearch(this.value)"
        onkeyup="if(event.key==='Enter'){ onSearch(this.value); }" />
      <button class="search-btn" onclick="onSearch(document.getElementById('searchInput').value)">검색</button>
    </div>

    <div class="actions">
      <button onclick="enterAdmin()">관리자</button>
    </div>
  </header>

  <main id="app"></main>

  <!-- 모달 -->
  <div id="modal" class="modal hidden" onclick="closeModal(event)">
    <div class="modal-content" onclick="event.stopPropagation()">
      <div class="modal-header">
        <h3 id="modalTitle">입력</h3>
        <button class="ghost" onclick="hideModal()">닫기</button>
      </div>
      <div id="modalBody"></div>
      <div class="modal-actions">
        <button id="modalSubmit">확인</button>
      </div>
    </div>
  </div>

  <!-- 관리자 바 -->
  <div id="adminBar" class="hidden" 
       style="position:fixed; bottom:20px; right:20px; background:#0044cc; color:#fff; padding:10px; border-radius:8px;">
    <button onclick="showAddCategory()">카테고리 추가</button>
    <button onclick="showAddManual()">매뉴얼 추가</button>
    <button onclick="exportData()">데이터 내보내기(JSON)</button>
    <button onclick="exitAdmin()">관리자 종료</button>
  </div>

  <!-- JS 최신 로드 -->
  <script>
    document.write(`<script src="app.js?v=${Date.now()}"><\/script>`);
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>영업시설 매뉴얼</title>
  <link rel="manifest" href="manifest.json">
  <!-- PWA 색상(안드로이드 툴바 색) -->
  <meta name="theme-color" content="#1778b9">

  <!-- iOS: 홈화면 추가 허용 + 상태바 스타일 -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="스마트한 영업시설 매뉴얼">

  <!-- iOS 아이콘(최소 180x180 권장) -->
  <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">

  <!-- JS로 동적으로 CSS 최신 로드 -->
  <script>
    const ts = Date.now();
    document.write(`<link rel="stylesheet" href="styles.css?v=${ts}">`);
  </script>
</head>
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('./service-worker.js?swv=' + Date.now())
  .then(async (reg) => {
    if (reg.waiting) reg.waiting.postMessage({type:'SKIP_WAITING'});
    if (reg.installing) reg.installing.addEventListener('statechange', () => {
      if (reg.installing.state === 'installed') reg.installing.postMessage({type:'SKIP_WAITING'});
    });
  });
}
</script>
<body>
  <!-- 상단 배너 -->
  <header class="app-bar">
    <div class="brand" onclick="navigate('home')">
      <!-- 로고 SVG (그대로) -->
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96.1958 49.0958" width="97" height="51">
        <defs>
          <filter id="whiteOutline">
            <feMorphology in="SourceAlpha" operator="dilate" radius="1" result="spread"/>
            <feFlood flood-color="#ffffff" result="white"/>
            <feComposite in="white" in2="spread" operator="in" result="outline"/>
            <feMerge>
              <feMergeNode in="outline"/>
              <feMergeNode in="SourceGraphic"/>
            </feMerge>
          </filter>
          <style>
            .s0{fill:#ec1b2f}
            .s1{fill:#7a2a2d}
            .s2{fill:#0376bd}
            .s3{fill:#2b3887}
          </style>
        </defs>
        <g transform="translate(-189.6191 -471.9952)" filter="url(#whiteOutline)">
          <g>
            <path class="s0" d="m250.93 491.15c-2.27 2.24-4.96 2.7-8.3 2.7h-28.61c-2.28 0-4.3-1.84-5.24-4.43h-7.43c1.35 6.25 6.52 10.92 12.67 10.92h28.61c4.07 0 9.3-0.55 13.63-4.81l4.68-4.61-4.89-4.81c-2.79 2.75-5.12 5.04-5.12 5.04z"/>
            <path class="s0" d="m214.02 478.49h18.65c0.82 0 1.74 0.91 1.74 2.21 0 1.31-0.92 2.22-1.74 2.22h-23.89c-0.36 0.99-0.57 2.1-0.57 3.25 0 1.15 0.21 2.25 0.57 3.25h23.89c4.94 0 8.95-3.91 8.95-8.72 0-4.8-4.01-8.7-8.95-8.7h-18.65c-6.15 0-11.32 4.67-12.67 10.92h7.43c0.94-2.59 2.96-4.43 5.24-4.43z"/>
            <path class="s1" d="m208.21 486.17c0-1.15 0.21-2.26 0.57-3.25h-7.43q-0.35 1.57-0.35 3.25 0 1.68 0.35 3.25h7.43c-0.36-1-0.57-2.1-0.57-3.25z"/>
            <path class="s0" d="m201.35 482.92h-8.13c-1.99 0-3.6 1.46-3.6 3.25 0 1.79 1.61 3.25 3.6 3.25h8.13q-0.35-1.57-0.35-3.25 0-1.68 0.35-3.25z"/>
            <path class="s0" d="m270.83 481.19c2.28-2.24 4.97-2.7 8.3-2.7h2.38c1.99 0 3.61-1.45 3.61-3.25 0-1.79-1.62-3.24-3.61-3.24h-2.38c-4.07 0-9.29 0.54-13.62 4.8 0 0-2.03 2-4.57 4.5l4.89 4.81z"/>
            <path class="s2" d="m255.79 476.24c-2.06-2.03-4.63-3.58-7.48-4.15-1.94-0.39-3.91 0.53-4.44 2.26-0.54 1.73 0.59 3.52 2.51 4 1.62 0.4 2.92 1.13 4.08 2.28l5.59 5.48c1.59-1.57 3.34-3.28 4.89-4.81z"/>
            <path class="s2" d="m281.55 493.79h-2.37c-3.34 0-6.03-0.46-8.3-2.7l-5.05-4.98-4.89 4.81 4.61 4.56c4.33 4.26 9.56 4.81 13.63 4.81h2.37c2 0 3.61-1.46 3.61-3.25 0-1.8-1.61-3.25-3.61-3.25z"/>
            <path class="s3" d="m260.94 481.3c-1.55 1.53-3.3 3.24-4.89 4.81l4.89 4.81 4.89-4.81z"/>
            <path class="s3" d="m264.66 510.41h1.44v10.26h-1.44v-6.12h-1.61v-1h1.61z"/>
            <path class="s3" d="m256.19 510.41h-1.45v10.26h1.45v-6.12h1.19v-1h-1.19z"/>
            <path class="s3" d="m251.7 512.62v-2.12h-1.44v2.12c0 1.73-0.69 3.16-2.3 4.17l0.63 0.82c1.07-0.56 1.87-1.41 2.39-2.33 0.53 0.92 1.33 1.77 2.4 2.33l0.63-0.82c-1.62-1.01-2.31-2.44-2.31-4.17z"/>
            <path class="s3" d="m274.55 510.41h1.44v10.26h-1.44z"/>
            <path class="s3" d="m261.36 512.62v-2.12h-1.45v2.12c0 1.73-0.69 3.16-2.3 4.17l0.63 0.82c1.07-0.56 1.87-1.41 2.4-2.33 0.52 0.92 1.32 1.77 2.39 2.33l0.63-0.82c-1.61-1.01-2.3-2.44-2.3-4.17z"/>
            <path class="s3" d="m208.38 513.1v-2.69h-1.44v7.47h1.44v-3.78h1.2v-1z"/>
            <path class="s3" d="m205.66 513.83c0-0.78-0.37-1.44-0.94-1.87h1v-1h-2.01v-0.91h-1.45v0.91h-2.01v1h1.04c-0.58 0.43-0.94 1.09-0.94 1.87 0 1.41 1.19 2.55 2.65 2.55 1.47 0 2.66-1.14 2.66-2.55z"/>
            <path class="s3" d="m208.46 520.64v-1h-5.41v-2.22h-1.44v2.37c0 0.44 0.35 0.85 0.91 0.85z"/>
            <path class="s3" d="m220.97 510.55v1 3.5 0.02c0 0.44 0.35 0.85 0.91 0.85h1.85v3h-3.29v1h8.03v-1h-3.29v-3h2.59v-1h-5.35v-3.37h5.35v-1z"/>
            <path class="s3" d="m215.39 516.81v-1.72h3.44v-0.99h-0.72v-2.7c0-0.44-0.35-0.85-0.91-0.85h-0.54-5.65v1h5.65v2.55h-6.16v0.99h3.45v1.72h-2.94v1h5.65v2.86h1.45v-3.86z"/>
            <path class="s3" d="m230.25 515.67c0 0.45 0.35 0.86 0.91 0.86h1.93v2.39h-3.37v1h8.18v-1h-3.37v-2.39h2.68v-1h-5.52v-1.42h5.52v-2.71c0-0.44-0.35-0.85-0.91-0.85h-6.05v1h5.51v1.56h-5.51z"/>
            <path class="s3" d="m239.63 510.55v1h5.58v3.27h-2.01v-1.94h-1.45v1.94h-2.85v1h8.63v-1h-0.88v-3.27-0.15c0-0.44-0.35-0.85-0.91-0.85z"/>
            <path class="s3" d="m243.17 516.36c-1.71 0-3.09 1.06-3.09 2.36 0 1.31 1.38 2.37 3.09 2.37 1.7 0 3.08-1.06 3.08-2.37 0-1.3-1.38-2.36-3.08-2.36zm0 3.76c-0.91 0-1.65-0.63-1.65-1.4 0-0.77 0.74-1.39 1.65-1.39 0.91 0 1.64 0.62 1.64 1.39 0 0.77-0.73 1.4-1.64 1.4z"/>
            <path class="s3" d="m271.6 510.42l-0.01 3.1h-2.16l-0.01-3.1h-1.43v6.7 0.02c0 0.44 0.35 0.85 0.91 0.85h3.22c0.56 0 0.91-0.41 0.91-0.85v-0.02-6.7zm-2.17 6.58v-2.48h2.16l-0.01 2.48z"/>
            <path class="s3" d="m280.91 518.94h-3.36v1h8.17v-1h-3.36z"/>
            <path class="s3" d="m282.39 511.55v-1.05h-1.51v1.05c0 1.73-1.74 3.5-3.43 4.51l0.66 0.94c1.12-0.56 2.77-1.96 3.52-3.2"/>
            <path class="s3" d="m280.88 511.55v-1.05h1.51v1.05c0 1.73 1.74 3.62 3.42 4.63l-0.66 0.82c-1.11-0.56-2.76-1.96-3.52-3.2"/>
          </g>
        </g>
      </svg>
      <span>스마트한 영업시설 매뉴얼</span>
    </div>

    <!-- ✅ 검색 버튼 제거, 입력창 안쪽 오른쪽에 아이콘 버튼 배치 -->
    <div class="search-wrap">
      <div class="search-input">
        <input id="searchInput" type="search" placeholder="검색: 통행권, 민원, 화재..."
               onkeydown="if(event.key==='Enter'){ onSearch(); }" />
        <button class="search-icon-btn" onclick="onSearch()" aria-label="검색">
          <!-- 심플 돋보기 아이콘 (테마색 #1778b9) -->
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" 
           viewBox="0 0 24 24" fill="none" 
           stroke="currentColor" stroke-width="2.5" 
           stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="7"/>
          <line x1="16.5" y1="16.5" x2="21" y2="21"/>
         </svg>
        </button>
      </div>
    </div>

    <div class="actions">
      <button onclick="enterAdmin()">관리자</button>
    </div>
  </header>

  <main id="app"></main>

  <!-- 모달 -->
  <div id="modal" class="modal hidden" onclick="closeModal(event)">
    <div class="modal-content" onclick="event.stopPropagation()">
      <div class="modal-header">
        <h3 id="modalTitle">입력</h3>
        <button class="ghost" onclick="hideModal()">닫기</button>
      </div>
      <div id="modalBody"></div>
      <div class="modal-actions">
        <button id="modalSubmit">확인</button>
      </div>
    </div>
  </div>

  <!-- 관리자 바 -->
  <div id="adminBar" class="hidden" 
       style="position:fixed; bottom:20px; right:20px; background:#0044cc; color:#fff; padding:10px; border-radius:8px;">
    <button onclick="showAddCategory()">카테고리 추가</button>
    <button onclick="showAddManual()">매뉴얼 추가</button>
    <button onclick="exportData()">데이터 내보내기(JSON)</button>
    <button onclick="exitAdmin()">관리자 종료</button>
  </div>

  <!-- JS 최신 로드 -->
  <script>
    document.write(`<script src="app.js?v=${Date.now()}"><\/script>`);
  </script>
</body>
</html>
